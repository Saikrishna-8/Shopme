<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments::page_head('Manage Brands','none')"></head>
<body>
	<div class="container-fluid">
		<div th:replace="navigation :: menu"></div>
		<div>
			<h1>Manage Products</h1>
		</div>

		<div>
			<a class="fa-solid fa-folder-plus" th:href="@{/products/new}"
				title="Add Product"> </a> &nbsp;| &nbsp; <a
				class="fa-solid fa-file-csv" th:href="@{/products/export/csv}"
				title="Export to CSV"></a> &nbsp;| &nbsp; <a
				class="fa-solid fa-file-excel" th:href="@{/products/export/excel}"
				title="Export to Excel"></a> &nbsp;| &nbsp; <a
				class="fa-solid fa-file-pdf" th:href="@{/products/export/pdf}"
				title="Export to Pdf"></a>
		</div>

		<div>
			<form th:action="@{/products/page/1}" class="form-inline m-3">
				<input type="hidden" name="sortDir" th:value="${sortDir}" /> <input
					type="search" name="keyword" th:value="${keyword}"
					class="form-control searchField" placeholder="Search" required>&nbsp;&nbsp;

				<button type="submit" class="btn">
					<i class="fas fa-search"></i>
				</button>
				&nbsp;&nbsp;

				<button type="button" class="btn clearSearch">
					<i class="fas fa-eraser"></i>
				</button>
			</form>
		</div>

		<div th:if="${message!=null}" class="alert alert-success text-center">
			[[${message}]]</div>
		<div class="full-details">
			<table
				class="table table-bordered table-striped table-hover table-responsive-xl">
				<thead class="thead-dark">
					<tr>
						<th>Id</th>
						<th>Main Image</th>
						<th><a class="text-white"
							th:href="@{/products/page/1?sortDir={sd}&sortField=name&keyword={kw} (sd=${sortDir=='asc' ? 'dsc':'asc'},kw=${keyword} )}"
							th:class="${sortDir=='asc'? 'fas fa-sort-up':'fas fa-sort-down'}">
								Product Name </a></th>
						<th>Brand</th>
						<th>Category</th>
						<th>Enabled</th>
						<th>Actions</th>
					</tr>
				</thead>

				<tbody>
					<tr th:each="product:${listOfProducts}">
						<td>[[${product.id}]]</td>
						<td></td>
						<td>[[${product.name}]]</td>

						<td>[[${product.brand.name}]]</td>
						<td>[[${product.category.name}]]</td>

						<td><a th:if="${product.enabled==true}"
							th:href="@{/products/enable/{id}?enabled=false (id=${product.id})}"
							class="fa-solid fa-circle-check icon-green"
							title="Disable Product"></a> <a th:if="${product.enabled!=true}"
							th:href="@{/products/enable/{id}?enabled=true (id=${product.id}) }"
							class="fa-solid fa-circle icon-silver" title="Enable Product"></a>
						</td>


						<td><a class="fas fa-file-alt icon-green"
							th:href="@{'/products/detail/'+${product.id}}"
							title="view details of this product"></a> &nbsp; <a
							class="fa-solid fa-pen-to-square icon-green"
							th:href="@{/products/edit/{pgNo}/{id} (id=${product.id} ,pgNo=${pageNumber} ) }"
							title="Edit The Product"> </a> &nbsp; <a
							class="fa-solid fa-trash link-delete icon-red"
							th:name="${product.name}" th:id="${product.id}"
							th:href="@{/products/delete/{id} (id=${product.id} , pgNo=${pageNumber})}"
							title="Delete The Product"> </a></td>

					</tr>

				</tbody>
			</table>
		</div>



		<div th:replace="modal_fragments::confirm-model('Delete product')"></div>
		<div th:replace="fragments::footer"></div>

		<script type="text/javascript">
			moduleURL = "[[@{/brands}]]"
			$(document)
					.ready(
							function() {
								$(".link-delete")
										.on(
												"click",
												function(e) {
													e.preventDefault();
													link = $(this);
													$(".yesbutton").attr(
															"href",
															link.attr("href"));

													showModalDialog("Are you Sure Want to Delete product ["
															+ $(this).attr(
																	"name")
															+ "] Id ["
															+ $(this)
																	.attr("id")
															+ "] ?");
												})

								$(".clearSearch").on("click", function(e) {
									location.replace("[[@{/products}]]")
								})
							});

			function showModalDialog(message) {
				$("#modalBody").text(message);
				$("#modalDialog").modal();
			}
		</script>
</body>
</html>